@using Models
@model AssignmentViewModel
<script asp-add-nonce>
    $(document).ready(function () { 
		$.InitializeDeliveryFieldValidations = function(count)
        {
			let reqs = [];			
			for (let idx = 0; idx < count; idx++) {
				reqs.push({name: "DeliveryList[" + idx + "].ApproverRemarks", el: "Input", minlength:0, maxlength:0, isrequired: false, description: "ApproverRemarks"});
				reqs.push({name: "DeliveryList[" + idx + "].Status", el: "Input", minlength:0, maxlength:0, isrequired: false, description: "Status"});
				reqs.push({name: "DeliveryList[" + idx + "].EndorserRemarks", el: "Input", minlength:0, maxlength:255, isrequired: false, description: "EndorserRemarks"});
				reqs.push({name: "DeliveryList[" + idx + "].EndorsedDate", el: "Input", minlength:0, maxlength:0, isrequired: false, description: "Endorsed Date"});
				reqs.push({name: "DeliveryList[" + idx + "].ApprovedTag", el: "Input", minlength:0, maxlength:0, isrequired: false, description: "Approved Tag"});
				reqs.push({name: "DeliveryList[" + idx + "].EndorsedTag", el: "Input", minlength:0, maxlength:0, isrequired: false, description: "Endorsed Tag"});
				reqs.push({name: "DeliveryList[" + idx + "].DeliveryCode", el: "Input", minlength:0, maxlength:0, isrequired: true, description: "Delivery Code"});
				reqs.push({name: "DeliveryList[" + idx + "].ActualDeliveryDate", el: "Input", minlength:0, maxlength:0, isrequired: true, description: "Actual Delivery Date"});
				reqs.push({name: "DeliveryList[" + idx + "].DeliveryAttachment", el: "Input", minlength:0, maxlength:0, isrequired: true, description: "Delivery Attachment"});
				reqs.push({name: "DeliveryList[" + idx + "].ActualDeliveryRemarks", el: "Input", minlength:0, maxlength:255, isrequired: false, description: "Actual Delivery Remarks"});
				reqs.push({name: "DeliveryList[" + idx + "].AssignmentCode", el: "Input", minlength:0, maxlength:0, isrequired: true, description: "Assignment Code"});
				reqs.push({name: "DeliveryList[" + idx + "].DueDate", el: "Input", minlength:0, maxlength:0, isrequired: false, description: "Due Date"});
				
			}
			let validator = $("#assignment-form").validate();
			for (let j in reqs)
			{
				let e = reqs[j];
				let el = $(`*[name="${e.name}"]`);
				el.rules("add", {
					required: {                
						depends: function(element) {
							return e.isrequired;
						}
					},
					messages: {
						required: (e.description === '') ? 'this field is required' : `'${e.description}' is required`,
					},
				});
				if(e.isrequired == true)
				{
					let labelElement = $(`label[name="Label.${e.name}"]`);
					$(labelElement).addClass("fieldrequired");
				}
				if(e.maxlength > 0) {el.attr('maxlength', e.maxlength);}
				if(e.minlength > 0) {el.attr('minlength', e.minlength);}   
			} 
		}       
    });
</script>